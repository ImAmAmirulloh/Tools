<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Kalkulator Statistika Lengkap</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0px; }
        .container { margin: 0px; padding: 30px; }
        .input-section { display: flex; align-items: flex-start; margin-bottom: 30px; }
        .input-group { margin-right: 40px; }
        .input-row { display: flex; align-items: center; margin-bottom: 10px; }
        .input-row label { width: 100px; font-weight: bold; text-align: right; margin-right: 10px; }
        .input-row input { width: 100px; padding: 5px; border: 1px solid #000; text-align: center; font-size: 1em; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1em; margin-top: 20px; }
        button:hover { background-color: #0056b3; }

        .calculation-steps { margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee; }
        .step-row { display: flex; align-items: center; margin-bottom: 25px; font-size: 1.1em; font-weight: bold; }
        .step-row span { margin-right: 10px; }
        .fraction-container { display: flex; flex-direction: column; align-items: center; margin: 0 5px; }
        .numerator, .denominator { padding: 2px 5px; white-space: nowrap; }
        .fraction-line { width: 100%; border-bottom: 1px solid black; margin: 0; padding: 0; }
        .result-box { border: 1px solid black; padding: 2px 5px; margin: 0 2px; font-family: 'Courier New', Courier, monospace; display: inline-block; text-align: center; }
        .sqrt-symbol { font-size: 1.5em; margin-right: 2px; line-height: 1; }
        .section-separator { margin: 40px 0; border: none; border-top: 3px double #aaa; }
        .reliability-status { font-size: 1.3em; margin-top: 20px; padding: 10px; border-left: 5px solid #007bff; background: #f0f7ff; }
    </style>
</head>
<body>

<div class="container">
    <h2>Kalkulator Korelasi, Uji t, & Reliabilitas</h2>
    <div class="input-section">
        <div class="input-group">
            <div class="input-row"><label>ΣX</label><input type="text" id="sumX" value="36"></div>
            <div class="input-row"><label>ΣY</label><input type="text" id="sumY" value="192"></div>
            <div class="input-row"><label>ΣX²</label><input type="text" id="sumX2" value="138"></div>
            <div class="input-row"><label>ΣY²</label><input type="text" id="sumY2" value="3762"></div>
            <div class="input-row"><label>ΣXY</label><input type="text" id="sumXY" value="705"></div>
            <div class="input-row"><label>n</label><input type="text" id="n" value="10"></div>
            <div class="input-row"><label>r Tabel</label><input type="text" id="rTabel" value="0.707"></div>
            <button onclick="hitungSemua()">Hitung Semua Langkah</button>
        </div>
    </div>

    <div id="outputSteps" class="calculation-steps"></div>
    <hr class="section-separator">
    <div id="outputUjiT" class="calculation-steps"></div>
    <hr class="section-separator">
    <div id="outputReliabilitas" class="calculation-steps"></div>
</div>

<script>
    // Fungsi createBox ditingkatkan agar bisa menerima argumen pembulatan opsional
    function createBox(value, decimals = null) {
        let displayValue = (decimals !== null) ? parseFloat(value).toFixed(decimals) : value;
        return `<span class="result-box">${displayValue}</span>`;
    }

    function createFraction(num, den) {
        return `<div class="fraction-container"><span class="numerator">${num}</span><span class="fraction-line"></span><span class="denominator">${den}</span></div>`;
    }

    function hitungSemua() {
        const n = parseFloat(document.getElementById('n').value);
        const sumX = parseFloat(document.getElementById('sumX').value);
        const sumY = parseFloat(document.getElementById('sumY').value);
        const sumX2 = parseFloat(document.getElementById('sumX2').value);
        const sumY2 = parseFloat(document.getElementById('sumY2').value);
        const sumXY = parseFloat(document.getElementById('sumXY').value);
        const rTabel = parseFloat(document.getElementById('rTabel').value);

        if ([n, sumX, sumY, sumX2, sumY2, sumXY, rTabel].some(isNaN)) return;

        // --- 1. Pearson r ---
        const numeratorR = (n * sumXY) - (sumX * sumY);
        const partX = (n * sumX2) - Math.pow(sumX, 2);
        const partY = (n * sumY2) - Math.pow(sumY, 2);
        const productXY = partX * partY;
        const denR = Math.sqrt(productXY);
        const rHitung = numeratorR / denR;

        document.getElementById('outputSteps').innerHTML = `
            <h3>1. Perhitungan Korelasi Pearson (r)</h3>
            <div class="step-row"><span>r =</span>${createFraction(createBox(numeratorR), `<span class="sqrt-symbol">√</span>${createBox(productXY)}`)}</div>
            <div class="step-row"><span>r =</span>${createFraction(createBox(numeratorR), createBox(denR, 4))}</div>
            <div class="step-row" style="color:#0056b3;"><span>r =</span>${createBox(rHitung)}</div>
        `;

        // --- 2. Uji t ---
        const tNum = rHitung * Math.sqrt(n - 2);
        const tDen = Math.sqrt(1 - Math.pow(rHitung, 2));
        const tHitung = tNum / tDen;

        document.getElementById('outputUjiT').innerHTML = `
            <h3>2. Uji Signifikansi (Uji t)</h3>
            <div class="step-row"><span>t =</span>${createFraction(`${createBox(rHitung, 2)} <span class="sqrt-symbol">√</span>${createBox(n-2)}`, `<span class="sqrt-symbol">√</span>1 - ${createBox(Math.pow(rHitung, 2), 4)}`)}</div>
            <div class="step-row" style="color:#0056b3;"><span>t =</span>${createBox(tHitung)}</div>
        `;

        // --- 3. Uji Reliabilitas (Spearman-Brown) ---
        const rii_num = 2 * rHitung;
        const rii_den = 1 + rHitung;
        const rii = rii_num / rii_den;
        const status = (rii > rTabel) ? "Reliabel" : "Tidak Reliabel";

        document.getElementById('outputReliabilitas').innerHTML = `
            <h3>3. Uji Reliabilitas (Spearman-Grown)</h3>
            <div class="step-row"><span>r<sub>ii</sub> =</span> ${createFraction(`2 (${createBox(rHitung, 2)})`, `1 + ${createBox(rHitung, 2)}`)}</div>
            <div class="step-row"><span>r<sub>ii</sub> =</span> ${createFraction(createBox(rii_num, 2), createBox(rii_den, 2))}</div>
            <div class="step-row" style="color:#0056b3;"><span>r<sub>ii</sub> =</span> ${createBox(rii)}</div>
            <div class="reliability-status">
                r hitung (${rii.toFixed(3)}) ${rii > rTabel ? '>' : '<'} r tabel (${rTabel}) = <strong>${status}</strong>
            </div>
        `;
    }
    
    document.addEventListener('DOMContentLoaded', hitungSemua);
</script>
</body>
</html>