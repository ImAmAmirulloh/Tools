<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Kalkulator Korelasi Pearson & Uji t</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0px;
            /*background-color: #f4f4f9;*/
        }
        .container {
            /*max-width: 950px;*/
            margin: 0px;
            /*background: white;*/
            padding: 30px;
            /*border-radius: 8px;*/
            /*box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);*/
        }
        .input-section {
            display: flex;
            align-items: flex-start;
            margin-bottom: 30px;
        }
        .input-group {
            margin-right: 40px;
        }
        .input-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .input-row label {
            width: 80px;
            font-weight: bold;
            text-align: right;
            margin-right: 10px;
        }
        .input-row input {
            width: 80px;
            padding: 5px;
            border: 1px solid #000;
            text-align: center;
            font-size: 1em;
        }
        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 20px;
        }
        button:hover {
            background-color: #0056b3;
        }

        /* --- Styling Untuk Tampilan Perhitungan Langkah demi Langkah --- */
        .calculation-steps {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        .r-step, .t-step {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            font-size: 1.1em;
            font-weight: bold;
        }
        .r-step span, .t-step span {
            margin-right: 10px;
        }
        .fraction-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 5px;
        }
        .numerator, .denominator {
            padding: 2px 5px;
            white-space: nowrap;
        }
        .fraction-line {
            width: 100%;
            border-bottom: 1px solid black;
            margin: 0;
            padding: 0;
        }
        /* Style untuk kotak hasil (ReadOnly Input) */
        .result-box {
            /*border: 1px solid black;*/
            padding: 2px 5px;
            margin: 0 2px;
            font-family: 'Courier New', Courier, monospace;
            /*background-color: #fff;*/
            display: inline-block;
            text-align: center;
            /*min-width: 40px;*/
        }
        .sqrt-symbol {
            font-size: 1.5em;
            margin-right: 2px;
            line-height: 1; /* Penting agar simbol akar rapi */
        }
        .section-separator {
            margin: 40px 0;
            border: none;
            border-top: 3px double #aaa;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Kalkulator Korelasi Pearson & Uji t</h2>
    <div class="input-section">
        <div class="input-group">
            <div class="input-row">
                <label for="sumX">ΣX</label>
                <input type="text" id="sumX" value="36" oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
            </div>
            <div class="input-row">
                <label for="sumY">ΣY</label>
                <input type="text" id="sumY" value="192" oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
            </div>
            <div class="input-row">
                <label for="sumX2">ΣX²</label>
                <input type="text" id="sumX2" value="138" oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
            </div>
            <div class="input-row">
                <label for="sumY2">ΣY²</label>
                <input type="text" id="sumY2" value="3762" oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
            </div>
            <div class="input-row">
                <label for="sumXY">ΣXY</label>
                <input type="text" id="sumXY" value="705" oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
            </div>
             <div class="input-row">
                <label for="n">n</label>
                <input type="text" id="n" value="10" oninput="this.value = this.value.replace(/[^0-9.]/g, '')">
            </div>
            <button onclick="hitungKorelasiDanUjiT()">Hitung Semua Langkah</button>
        </div>
    </div>

    <div class="calculation-steps" id="outputSteps">
        </div>

    <hr class="section-separator">
    
    <div class="calculation-steps" id="outputUjiT">
        </div>
</div>

<script>
   /* function createBox(value, decimals = 0) {
        // Format angka dengan jumlah desimal tertentu
        const formattedValue = parseFloat(value).toFixed(decimals);
        // Fungsi untuk membuat elemen HTML yang terlihat seperti kotak input readonly
        return `<span class="result-box">${formattedValue}</span>`;
    }*/
    function createBox(value) {
        // Fungsi untuk membuat elemen HTML yang terlihat seperti kotak input readonly
        // Hapus toFixed() agar menampilkan nilai desimal penuh
        return `<span class="result-box">${value}</span>`;
    }

    function createFraction(numeratorHTML, denominatorHTML) {
        // Fungsi untuk membuat elemen HTML yang terlihat seperti pecahan
        return `
            <div class="fraction-container">
                <span class="numerator">${numeratorHTML}</span>
                <span class="fraction-line"></span>
                <span class="denominator">${denominatorHTML}</span>
            </div>
        `;
    }

    function hitungKorelasiDanUjiT() {
        // Ambil nilai dari input
        const n = parseFloat(document.getElementById('n').value);
        const sumX = parseFloat(document.getElementById('sumX').value);
        const sumY = parseFloat(document.getElementById('sumY').value);
        const sumX2 = parseFloat(document.getElementById('sumX2').value);
        const sumY2 = parseFloat(document.getElementById('sumY2').value);
        const sumXY = parseFloat(document.getElementById('sumXY').value);

        const outputRDiv = document.getElementById('outputSteps');
        const outputTDiv = document.getElementById('outputUjiT');
        
        if ([n, sumX, sumY, sumX2, sumY2, sumXY].some(isNaN)) {
            outputRDiv.innerHTML = "<p style='color: red; font-weight: bold;'>Harap isi semua kotak input dengan angka yang valid.</p>";
            outputTDiv.innerHTML = "";
            return;
        }

        // --- Bagian 1: Perhitungan Korelasi Pearson (r) ---
        
        const n_sumXY = n * sumXY;
        const sumX_sumY = sumX * sumY;
        const n_sumX2 = n * sumX2;
        const sumX_sq = sumX * sumX;
        const n_sumY2 = n * sumY2;
        const sumY_sq = sumY * sumY;
        
        const numerator = n_sumXY - sumX_sumY;
        const partX_sub = n_sumX2 - sumX_sq;
        const partY_sub = n_sumY2 - sumY_sq;
        const product_parts = partX_sub * partY_sub;
        const denominator_r = Math.sqrt(product_parts);
        const r_value = numerator / denominator_r;

        let outputRHTML = '<h3>1. Perhitungan Korelasi Pearson (r)</h3>';
        
        // Output langkah r (sama seperti sebelumnya)
        outputRHTML += `
            <div class="r-step">
                <span>r =</span>
                ${createFraction(
                    `${createBox(n)}(${createBox(sumXY)}) - (${createBox(sumX)})(${createBox(sumY)})`,
                    `<span class="sqrt-symbol">√</span>[${createBox(n)}(${createBox(sumX2)}) - (${createBox(sumX)})²][${createBox(n)}(${createBox(sumY2)}) - (${createBox(sumY)})²]`
                )}
            </div>
            <div class="r-step">
                <span>r =</span>
                ${createFraction(
                    `${createBox(n_sumXY)} - ${createBox(sumX_sumY)}`,
                    `<span class="sqrt-symbol">√</span>[${createBox(n_sumX2)} - ${createBox(sumX_sq)}][${createBox(n_sumY2)} - ${createBox(sumY_sq)}]`
                )}
            </div>
            <div class="r-step">
                <span>r =</span>
                ${createFraction(
                    `${createBox(numerator)}`,
                    `<span class="sqrt-symbol">√</span>[${createBox(partX_sub)}][${createBox(partY_sub)}]`
                )}
            </div>
            <div class="r-step">
                <span>r =</span>
                ${createFraction(
                    `${createBox(numerator)}`,
                    `<span class="sqrt-symbol">√</span>${createBox(product_parts)}`
                )}
            </div>
            <div class="r-step">
                <span>r =</span>
                ${createFraction(
                    `${createBox(numerator)}`,
                    `${createBox(denominator_r, 2)}`
                )}
            </div>
            <div class="r-step" style="font-size: 1.5em; color: #0056b3;">
                <span>r =</span>
                ${createBox(r_value, 2)}
            </div>
        `;
        outputRDiv.innerHTML = outputRHTML;

        // --- Bagian 2: Perhitungan Uji Signifikansi (Uji t) ---
        
        let outputTHTML = '<h3>2. Uji Signifikansi Korelasi (Uji t)</h3>';
        const r = r_value; // r = 0.54
        const n_minus_2 = n - 2; // n-2 = 10 - 2 = 8
        const r_squared = r * r; // r^2 = 0.54 * 0.54 = 0.2916
        const one_minus_r_sq = 1 - r_squared; // 1 - 0.2916 = 0.7084
        
        // Hitung Pembilang Uji t
        const sqrt_n_minus_2 = Math.sqrt(n_minus_2); // sqrt(8) = 2.8284...
        const t_numerator_final = r * sqrt_n_minus_2; // 0.54 * 2.8284... = 1.5273...

        // Hitung Penyebut Uji t
        const sqrt_one_minus_r_sq = Math.sqrt(one_minus_r_sq); // sqrt(0.7084) = 0.8416...

        // Hasil Akhir t
        const t_final = t_numerator_final / sqrt_one_minus_r_sq; // 1.5273... / 0.8416... = 1.8147...

        // Tampilan Rumus Uji t
        //outputTHTML += `<p>Rumus Uji t: <span style="font-style: italic;">$$t = \\frac{r \\sqrt{n-2}}{\\sqrt{1-r^2}}$$</span></p>`;

        // Step 1: Substitusi
        outputTHTML += `
            <div class="t-step">
                <span>t =</span>
                ${createFraction(
                    `${createBox(r, 2)} <span class="sqrt-symbol">√</span>${createBox(n)} - ${createBox(2)}`,
                    `<span class="sqrt-symbol">√</span>${createBox(1)} - (${createBox(r, 2)})²`
                )}
            </div>
        `;

        // Step 2: Hitung n-2 dan r²
        outputTHTML += `
            <div class="t-step">
                <span>t =</span>
                ${createFraction(
                    `${createBox(r, 2)} <span class="sqrt-symbol">√</span>${createBox(n_minus_2)}`,
                    `<span class="sqrt-symbol">√</span>${createBox(1)} - ${createBox(r_squared, 4)}`
                )}
            </div>
        `;

        // Step 3: Hitung 1-r² dan √n-2
        outputTHTML += `
            <div class="t-step">
                <span>t =</span>
                ${createFraction(
                    `${createBox(r, 2)} × ${createBox(sqrt_n_minus_2, 2)}`,
                    `<span class="sqrt-symbol">√</span>${createBox(one_minus_r_sq, 4)}`
                )}
            </div>
        `;
        
        // Step 4: Hitung Perkalian Pembilang
        outputTHTML += `
            <div class="t-step">
                <span>t =</span>
                ${createFraction(
                    `${createBox(t_numerator_final, 4)}`,
                    `${createBox(sqrt_one_minus_r_sq, 4)}`
                )}
            </div>
        `;
        
        // Final Result Uji t
        outputTHTML += `
            <div class="t-step" style="font-size: 1.5em; color: #0056b3;">
                <span>t =</span>
                ${createBox(t_final, 2)}
            </div>
        `;
        
        outputTDiv.innerHTML = outputTHTML;
    }

    // Panggil fungsi hitung saat halaman dimuat (untuk tampilan default)
    document.addEventListener('DOMContentLoaded', hitungKorelasiDanUjiT);
</script>

</body>
</html>